# Жизненный цикл компонента

----

**Жизненный цикл компонента** - это последовательность этапов, через которые проходит компонент от момента его создания до момента его удаления из DOM.

- Mount (монтирование)
- Update (обновление)
- Unmount (демонтирование)

1. **Mounting** - фаза, во время которой компонент впервые добавляется в DOM. 

Начинается процесс [рендеринга](./render.md)

- Рендер компонента, анализ JSX 
- вычисление локальных значений, вычисление стейтов 
- вычисление и мемоизация переменных  (если есть useMemo/useCallback) 
- рекурсивный рендер дочерних компонентов
- Вставка элементов в DOM (commit)
- Установка ref’ов на DOM-узлы
- Запуск Layout эффектов
- Отрисовка DOM дерева
- Запуск побочных эффектов после задержки

2. **update компонента**

**Компонент может обновиться по 2-ум причинам:**

- Обновились пропсы
- Обновился его стейт

Ререндеринг компонента неизбежно ведет к рекурсивному ререндерингу его дочерних компонентов, даже если их пропсы не были изменены (если они не мемоизированы при помощи React.memo()).

- Рендеринг. Перевычисление стейтов, локальных переменных, пропсов, вызов хуков с измененными зависимостями, рендеринг дочерних компонентов.
- Обновление DOM.
- Сброс ref
- Вызываются cleanup функции  Layout эффектов с предыдущими значениями
- После обновления DOM ref’ы получают новые значения.
- Вызов Layout эффектов.
- Перерисовка DOM.
- Вызов cleanup функций побочных эффектов с предыдущими значениями.
- Вызов побочных эффектов, если изменены зависимости.

3. **Unmount компонента**

Этап размонтирования и удаления компонента из DOM.

- Происходит финальный запуск cleanup-функций Layout эффектов
- Ансетятся ref’ы, так как удаляются DOM-элементы, на которые они ссылаются.
- Удаляются DOM-узлы.

- [React](./react.md) 